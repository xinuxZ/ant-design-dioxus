# BackTop 组件 TODO 清单

⚠️ **重要提示**: 根据 Ant Design 官方文档，BackTop 组件在 v5 版本中已被标记为废弃，建议使用 FloatButton 组件中的 `<FloatButton.BackTop>` 替代。

## 已实现功能 ✅

### 基础功能
- [x] 基础回到顶部功能
- [x] 滚动高度检测（visibility_height）
- [x] 平滑滚动到顶部
- [x] 自定义内容支持
- [x] 点击事件回调
- [x] 自定义样式和类名
- [x] 默认图标显示

### 滚动监听
- [x] 窗口滚动监听
- [x] 自定义容器滚动监听（target属性）
- [x] 滚动位置检测
- [x] 显示/隐藏状态管理

### 样式系统
- [x] 基础CSS样式
- [x] 固定定位
- [x] 显示动画效果
- [x] 自定义样式支持

### 开发工具
- [x] 便捷构造函数
- [x] Builder模式支持
- [x] 单元测试

## 缺失的核心功能 ❌

### 1. 动画和过渡效果 🔥
- [ ] **淡入淡出动画**：按钮显示/隐藏的平滑过渡效果
- [ ] **滚动动画配置**：支持自定义滚动动画时长和缓动函数
- [ ] **hover效果**：鼠标悬停时的视觉反馈
- [ ] **点击反馈**：点击时的视觉反馈效果

### 2. 高级配置选项 🔥
- [ ] **duration属性实现**：当前duration属性未实际使用
- [ ] **offset配置**：支持自定义距离底部和右侧的距离
- [ ] **shape配置**：支持不同的按钮形状（圆形、方形）
- [ ] **size配置**：支持不同的按钮尺寸

### 3. 性能优化 🔥
- [ ] **滚动事件节流**：避免频繁的滚动事件处理
- [ ] **Intersection Observer**：使用现代API优化性能
- [ ] **内存泄漏防护**：确保事件监听器正确清理
- [ ] **RAF优化**：使用requestAnimationFrame优化动画

### 4. 无障碍支持
- [ ] **ARIA标签**：添加适当的无障碍标签
- [ ] **键盘导航**：支持键盘操作
- [ ] **屏幕阅读器**：提供屏幕阅读器友好的描述
- [ ] **焦点管理**：正确的焦点状态管理

### 5. 主题系统
- [ ] **Design Token支持**：完整的设计令牌系统
- [ ] **主题定制**：支持主题色彩定制
- [ ] **暗色模式**：暗色主题支持
- [ ] **CSS变量**：使用CSS变量实现主题切换

### 6. 高级功能
- [ ] **多目标支持**：同时监听多个滚动容器
- [ ] **进度指示**：显示页面滚动进度
- [ ] **智能隐藏**：在页面顶部自动隐藏
- [ ] **位置记忆**：记住用户的滚动位置

### 7. 组件集成
- [ ] **FloatButton集成**：与FloatButton组件的集成
- [ ] **Affix集成**：与Affix组件的协同工作
- [ ] **Anchor集成**：与Anchor组件的联动
- [ ] **Layout集成**：与Layout组件的配合

### 8. 错误处理
- [ ] **容器检测**：检测目标容器是否存在
- [ ] **滚动能力检测**：检测容器是否可滚动
- [ ] **降级处理**：在不支持的环境中的降级方案
- [ ] **异常恢复**：滚动异常时的恢复机制

### 9. 开发体验
- [ ] **TypeScript类型**：完整的类型定义
- [ ] **文档完善**：详细的API文档和示例
- [ ] **测试覆盖**：全面的测试用例
- [ ] **Storybook**：组件展示和测试

### 10. 移动端优化
- [ ] **触摸优化**：移动端触摸体验优化
- [ ] **响应式设计**：不同屏幕尺寸的适配
- [ ] **手势支持**：支持手势操作
- [ ] **性能优化**：移动端性能优化

## 迁移建议 🚨

### 推荐迁移到 FloatButton
由于 BackTop 组件已被官方废弃，建议：

1. **新项目**：直接使用 `FloatButton.BackTop` 组件
2. **现有项目**：逐步迁移到 FloatButton 组件
3. **兼容性**：保持当前 BackTop 组件作为过渡方案
4. **文档说明**：在文档中明确标注废弃状态

### FloatButton.BackTop 优势
- 更现代的设计
- 更好的无障碍支持
- 更丰富的配置选项
- 更好的性能表现
- 官方长期支持

## 优先级建议

### P0 (必须实现)
1. **动画和过渡效果** - 提升用户体验
2. **性能优化** - 避免性能问题
3. **duration属性实现** - 完善现有API

### P1 (重要)
4. **无障碍支持** - 提升可访问性
5. **主题系统** - 与整体设计系统集成
6. **错误处理** - 提升组件稳定性

### P2 (可选)
7. **高级功能** - 增强用户体验
8. **组件集成** - 提升组件生态
9. **移动端优化** - 移动端体验优化

### P3 (长期)
10. **开发体验** - 提升开发效率

## 实现建议

### 技术方案
1. **参考Ant Design实现**：严格按照官方API设计
2. **现代Web API**：使用Intersection Observer等现代API
3. **性能优先**：避免频繁的DOM操作和事件处理
4. **渐进增强**：在不支持的环境中提供降级方案

### 架构设计
1. **Hook抽象**：将滚动监听逻辑抽象为自定义Hook
2. **事件管理**：统一的事件监听器管理
3. **状态管理**：清晰的组件状态管理
4. **内存安全**：确保没有内存泄漏

### 开发约束
1. **API兼容性**：保持与Ant Design API的一致性
2. **性能要求**：滚动事件处理不能影响页面性能
3. **浏览器兼容**：支持主流现代浏览器
4. **移动端友好**：确保移动端体验良好

---

> 参考文档：[Ant Design BackTop (v3)](https://3x.ant.design/components/back-top/)
> 
> ⚠️ **废弃提醒**：建议迁移到 [FloatButton.BackTop](https://ant.design/components/float-button/)
> 
> 当前实现基于 Dioxus 框架，需要在保持 API 兼容性的同时，充分利用 Rust 和 Dioxus 的特性优势。